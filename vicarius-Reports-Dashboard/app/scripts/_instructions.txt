Instructions for Using VickyTopiaReportCLI.py Script 

-----------------------------------------------------------------------------------------------------------------
PREREQUISITES
-----------------------------------------------------------------------------------------------------------------
Ensure that you have Python installed on your system.

Open a command prompt or terminal window

Navigate to the directory where the scripts are saved using the cd command.

Install the required dependencies for the scripts by running the following commands:

pip install requests
pip install pandas
pip install tqdm

Download and install the following programs
https://code.visualstudio.com/
https://www.python.org/downloads/
https://powerbi.microsoft.com/en-us/downloads/

-----------------------------------------------------------------------------------------------------------------

Run the VickyTopiaReportCLI.py script using the following command:

python VickyTopiaReportCLI.py -k YOUR_API_KEY -d https://xxxx.vicarius.cloud --allreports

Replace YOUR_API_KEY with your actual Topia API key and https://xxxx.vicarius.cloud with your dashboard URL.

Available Options. 

-----------------------------------------------------------------------------------------------------------------

state.json file

Set "lastEndpointsEventTask": <date in epoch nanoseconds> for minimun Task event date record to query 
Set "minDateIncidentEventVulnerabilities": <date in epoch nanoseconds>, for minimum Incident event date record to query


-k or --api-key: Specify the Topia API key.
-d or --dashboard: Specify the URL of the Topia dashboard.

--allreports: Retrieve all available reports.

Run each report in the following order:
-r or --resetstate: Trigger a reset of the state.
-a or --assetsreport: Retrieve assets reports.
-t or --taskreport: Retrieve task reports.
-v or --vulnerabilitiesreport: Retrieve vulnerabilities reports.
-p or --patchsreport: Retrieve patch versions reports.
-i or --incidentvulnerability: Retrieve incident vulnerabilities reports.
-mt or --mitigationtime: Retrieve the mitigation time.
-cd or --cleandata: Clean EndpointIncidentesVulnerabilities and Vulnerabilities report
Press Enter to execute the command.


The VickyTopiaReportCLI.py script will generate the following reports:

EndpointCountPatchs.csv
EndpointIncidentesVulnerabilities.csv
EndpointIncidentesVulnerabilitiesND.csv
EndpointPatchs.csv
Endpoints.csv
EndpointsEventTask.csv
EndpointsGroup.csv
MitigationTime.csv
Vulnerabilities.csv
VulnerabilitiesND.csv

Open Power BI and locate the Power BI file (.pbix) that corresponds to your report.

In Power BI, go to the "Home" tab and click on "Edit Queries" or "Transform Data" (depending on your Power BI version) to open the Power Query Editor.

In the Power Query Editor, locate each table that corresponds to the generated reports and update the directory paths to point to the cleaned versions of the reports. To do this, follow these steps for each table:

a. Right-click on the table and select "Advanced Editor" to open the Advanced Editor window.

b. In the Advanced Editor, locate the directory path that corresponds to the original report file.

c. Update the directory path to point to the corresponding cleaned report file generated by the cleanData.py script.

d. Click "Done" to save the changes for the table.

Repeat steps a to d for each table that corresponds to a generated report.

Save the changes in the Power Query Editor and close the editor.

Run each report in Power BI in the same order as the original reports were generated to ensure data consistency and accuracy.

Please ensure that all the necessary dependencies (requests for VickyTopiaReportCLI.py and pandas for cleanData.py) are installed using pip before running the respective scripts.

Make sure that the file names mentioned above match the actual file names generated by the VickyTopiaReportCLI.py script.